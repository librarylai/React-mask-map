{"version":3,"sources":["Components/ShopInfoComponent.js","Components/MarkerComponent.js","Components/NavMenuComponent.js","Containers/MapContainer.js","index.js"],"names":["ShopInfoComponent","this","props","shopItem","handleCardClick","properties","name","phone","address","mask_adult","mask_child","geometry","coordinates","lat","lon","className","onClick","Component","haveMarker","L","icon","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","noMarker","adultMarker","childMarker","MarkerComponent","shouldComponentUpdate","nextProps","nexState","data","getMarkerIcon","adultMaskCount","childMaskCount","renderMarkers","map","item","Marker","key","id","position","Popup","closeButton","closeOnClick","minWidth","NavMenuComponent","componentDidMount","moment","locale","renderCardInfo","handleSearchBarSubmit","format","placeholder","type","onKeyPress","MapContainer","fetchAPI","a","fetch","json","setState","apiData","features","handleMapAttrChange","attr","value","handleViewportChanged","viewport","state","center","lan","filterData","filter","itemLan","parseFloat","itemLat","zoom","e","persist","keyword","target","indexOf","Map","useFlyTo","minZoom","maxZoom","animate","onViewportChanged","TileLayer","attribution","url","showCoverageOnHover","App","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.3dbd9bd5.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport \"../Scss/ShopInfoComponent.scss\";\nclass ShopInfoComponent extends Component {\n  render() {\n    const { shopItem, handleCardClick } = this.props;\n    const {\n      name,\n      phone,\n      address,\n      mask_adult,\n      mask_child\n    } = shopItem.properties;\n    const [lat, lon] = shopItem.geometry.coordinates;\n    return (\n      <div\n        className=\"shopInfoComponent-container\"\n        onClick={() => (handleCardClick ? handleCardClick(lat, lon) : null)}\n      >\n        <p className=\"shopInfoComponent-container-title\">{name}</p>\n        <p className=\"shopInfoComponent-container-font\">{phone}</p>\n        <p className=\"shopInfoComponent-container-font\">{address}</p>\n        <div className=\"shopInfoComponent-container-rowBox\">\n          <p\n            className={`shopInfoComponent-container-rowBox-column ${\n              mask_adult ? \"blue\" : \"gray\"\n            }`}\n          >\n            <span>成人口罩</span>\n            <span>{mask_adult}</span>\n          </p>\n          <p\n            className={`shopInfoComponent-container-rowBox-column ${\n              mask_child ? \"red\" : \"gray\"\n            }`}\n          >\n            <span>兒童口罩</span>\n            <span>{mask_child}</span>\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\nexport default ShopInfoComponent;\n","import React, { Component, Fragment } from \"react\";\nimport { Marker, Popup } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport ShopInfoComponent from \"../Components/ShopInfoComponent\";\nconst haveMarker = L.icon({\n  iconUrl:\n    \"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png\",\n  shadowUrl:\n    \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png\",\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\nconst noMarker = L.icon({\n  iconUrl:\n    \"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png\",\n  shadowUrl:\n    \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png\",\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\nconst adultMarker = L.icon({\n  iconUrl:\n    \"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png\",\n  shadowUrl:\n    \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png\",\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\nconst childMarker = L.icon({\n  iconUrl:\n    \"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png\",\n  shadowUrl:\n    \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png\",\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\nclass MarkerComponent extends Component {\n  shouldComponentUpdate = (nextProps, nexState) => {\n    if (nextProps.data === this.props.data) return false;\n    return true;\n  };\n  getMarkerIcon = (adultMaskCount, childMaskCount) => {\n    if (adultMaskCount && childMaskCount) return haveMarker;\n    if (!adultMaskCount && !childMaskCount) return noMarker;\n    if (adultMaskCount) return adultMarker;\n    if (childMaskCount) return childMarker;\n  };\n  renderMarkers = () => {\n    const { data } = this.props;\n    if (!data) return;\n    return data.map(item => {\n      const { mask_adult, mask_child } = item.properties;\n      return (\n        <Marker\n          key={item.properties.id}\n          position={[\n            item.geometry.coordinates[1],\n            item.geometry.coordinates[0]\n          ]}\n          icon={this.getMarkerIcon(mask_adult, mask_child)}\n        >\n          <Popup closeButton={false} closeOnClick={true} minWidth={200}>\n            <ShopInfoComponent shopItem={item} />\n          </Popup>\n        </Marker>\n      );\n    });\n  };\n  render() {\n    return <Fragment>{this.renderMarkers()}</Fragment>;\n  }\n}\nexport default MarkerComponent;\n","import React, { Component, Fragment } from \"react\";\nimport moment from \"moment\";\nimport ShopInfoComponent from \"../Components/ShopInfoComponent\";\nimport \"../Scss/NavMenuComponent.scss\";\nclass NavMenuComponent extends Component {\n  componentDidMount = () => {\n    moment.locale();\n  };\n  renderCardInfo = () => {\n    const { data, handleCardClick } = this.props;\n    return data.map(item => {\n      return (\n        <div\n          key={item.properties.id}\n          className=\"navMenuComponent-shopListContainer-cardContent\"\n        >\n          <ShopInfoComponent\n            shopItem={item}\n            handleCardClick={handleCardClick}\n          />\n        </div>\n      );\n    });\n  };\n  render() {\n    const { handleSearchBarSubmit } = this.props;\n    return (\n      <Fragment>\n        <div className=\"navMenuComponent-titleContainer\">\n          <div className=\"navMenuComponent-titleContainer-content\">\n            <p className=\"navMenuComponent-titleContainer-title\">口罩查詢</p>\n            <div className=\"navMenuComponent-titleContainer-dateContent\">\n              <p>{moment().format(\"dddd\")}</p>\n              <p>{moment().format(\"YYYY/MM/DD\")}</p>\n            </div>\n          </div>\n          <div className=\"navMenuComponent-titleContainer-searchBar\">\n            <input\n              placeholder=\"搜尋區域,地址,藥局\"\n              type=\"text\"\n              onKeyPress={handleSearchBarSubmit}\n            />\n          </div>\n        </div>\n        <div className=\"navMenuComponent-shopListContainer\">\n          {this.renderCardInfo()}\n        </div>\n      </Fragment>\n    );\n  }\n}\nexport default NavMenuComponent;\n","import React, { Component } from \"react\";\nimport { Map, TileLayer } from \"react-leaflet\";\nimport MarkerComponent from \"../Components/MarkerComponent\";\nimport NavMenuComponent from \"../Components/NavMenuComponent\";\nimport MarkerClusterGroup from \"react-leaflet-markercluster\";\nimport \"react-leaflet-markercluster/dist/styles.min.css\";\nimport \"../Scss/MapContainer.scss\";\nclass MapContainer extends Component {\n  constructor() {\n    super();\n    this.state = {\n      apiData: [],\n      data: [],\n      viewport: {\n        center: [25.04836, 121.56066],\n        zoom: 10\n      },\n      keyword: \"\"\n    };\n  }\n\n  componentDidMount = () => {\n    this.fetchAPI();\n  };\n\n  fetchAPI = async () => {\n    let data = await (await fetch(\n      \"https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json\"\n    )).json();\n    this.setState({\n      apiData: data.features,\n      data: data.features\n    });\n  };\n  handleMapAttrChange = (attr, value) => {\n    this.setState({\n      [attr]: value\n    });\n  };\n  handleViewportChanged = viewport => {\n    const { apiData } = this.state;\n    let [lan, lat] = viewport.center;\n    let filterData = apiData.filter(item => {\n      let itemLan = parseFloat(item.geometry.coordinates[1]);\n      let itemLat = parseFloat(item.geometry.coordinates[0]);\n      return (\n        itemLan <= lan + 0.05 &&\n        itemLan >= lan - 0.05 &&\n        itemLat <= lat + 0.05 &&\n        itemLat >= lat - 0.05\n      );\n    });\n    this.setState({\n      viewport: {\n        center: [viewport.center[0], viewport.center[1]],\n        zoom: viewport.zoom\n      },\n      data: filterData\n    });\n  };\n\n  handleSearchBarSubmit = e => {\n    e.persist(); // 保留住 Event 事件\n    if (e.key !== \"Enter\") return; // onKeyPress 事件\n    const { apiData } = this.state;\n    let keyword = e.target.value;\n    let filterData = apiData.filter(item => {\n      const { name, address } = item.properties;\n      let dataString = name + address;\n      return dataString.indexOf(e.target.value) !== -1;\n    });\n    this.handleMapAttrChange(\"data\", keyword ? filterData : apiData);\n  };\n  handleCardClick = (lat, lon) => {\n    this.setState({\n      viewport: {\n        center: [lon, lat],\n        zoom: 18\n      }\n    });\n  };\n\n  render() {\n    const { viewport, data, apiData } = this.state;\n    return (\n      <div className=\"mapContainer-container\">\n        <div className=\"mapContainer-container-controllContent\">\n          <NavMenuComponent\n            data={data}\n            viewport={viewport}\n            handleCardClick={this.handleCardClick}\n            handleSearchBarSubmit={this.handleSearchBarSubmit}\n          />\n        </div>\n        <div className=\"mapContainer-container-mapContent\">\n          <Map\n            useFlyTo={true}\n            className=\"mapContainer-container-mapContent-map\"\n            center={viewport.center}\n            zoom={viewport.zoom}\n            minZoom={3}\n            maxZoom={25}\n            animate={true}\n            onViewportChanged={this.handleViewportChanged}\n          >\n            <TileLayer\n              attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n              url=\"https://{s}.tile.osm.org/{z}/{x}/{y}.png\"\n            />\n            <MarkerClusterGroup showCoverageOnHover={true}>\n              <MarkerComponent data={apiData} />\n            </MarkerClusterGroup>\n          </Map>\n        </div>\n      </div>\n    );\n  }\n}\nexport default MapContainer;\n","import React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport MapContainer from \"./Containers/MapContainer\";\nimport \"./styles.scss\";\n\nclass App extends Component {\n  render() {\n    return <MapContainer />;\n  }\n}\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<App />, rootElement);\n"],"sourceRoot":""}